(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{44:function(e,t,a){e.exports=a(87)},49:function(e,t,a){},83:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(36),l=a.n(r),o=(a(49),a(13)),s=a(14),c=a(18),m=a(15),u=a(17),g=a(90),h=a(37),f=a.n(h),d=a(4),y=a.n(d),p=new f.a,v=function(e){function t(){var e;Object(o.a)(this,t);var a=(e=Object(c.a)(this,Object(m.a)(t).call(this))).getHashParams(),n=a.access_token;return n&&p.setAccessToken(n),e.state={loggedIn:!!n,nowPlaying:{name:"Nothing is playing",albumArt:"",lyrics:[],time_left:0,total_time:0}},console.log(a),e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"getHashParams",value:function(){var e,t={},a=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);for(e=a.exec(n);e;)t[e[1]]=decodeURIComponent(e[2]),e=a.exec(n);return t}},{key:"hasChanged",value:function(){var e=this;p.getMyCurrentPlaybackState().then(function(t){if(t.is_playing)if(console.log(t),console.log(t.item.name),console.log(e.state.nowPlaying.name),t.item.name.valueOf()!==e.state.nowPlaying.name.valueOf())e.getNowPlaying(),e.setState({nowPlaying:{name:t.item.name,artist:t.item.artists[0].name,albumArt:"undefined"===typeof t.item.album?t.item.album.images[0].url:"",total_time:t.item.duration_ms,time_left:t.item.duration_ms-t.progress_ms,lyrics:[]}});else{var a=e.state.nowPlaying,n=a.name,i=a.artist,r=a.total_time,l=a.lyrics;e.setState({nowPlaying:{name:n,artist:i,albumArt:"undefined"!==typeof t.item.album?t.item.album.images[0].url:"",total_time:r,time_left:t.item.duration_ms-t.progress_ms,lyrics:l}})}else{var o=e.state.nowPlaying,s=o.artist,c=o.albumArt,m=o.total_time,u=o.lyrics;e.setState({nowPlaying:{name:"Nothing is Playing",artist:s,albumArt:c,total_time:m,time_left:0,lyrics:u}})}})}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return e.hasChanged()},3e3),y()(document).on("mousemove",function(e){y()(".light").css({left:e.pageX-300,top:e.pageY-300})});var t=y()(".js-tilt-container");t.on("mousemove",function(e){var t=y()(this).offset(),a=t.left,n=t.top,i=e.pageX-a,r=e.pageY-n,l=y()(this).width()/2-i,o=y()(this).height()/2-r;y()(this).css("transform","perspective(500px) rotateX("+o/40+"deg) rotateY("+-l/40+"deg) translateZ(10px)");var s=Math.sign(l)>0?-Math.abs(l):Math.abs(l);y()(this).find(".js-perspective-neg").css("transform","translateY("+o/10+"px) translateX("+-s/10+"px) scale(1.15)"),y()(this).removeClass("leave")}),t.on("mouseleave",function(){y()(this).addClass("leave")})}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"getNowPlaying",value:function(){var e=this;p.getMyCurrentPlaybackState().then(function(t){var a=t.item.artists[0].name.replace(/[^\w\s]/g,"");t.item.artists[1]&&(a=a+" "+t.item.artists[1].name.replace(/[^\w\s]/g,"")),console.log(t),console.log(a);var n=t.item.name.split("(")[0];console.log(n),n=(n=(n=(n=(n=t.item.name.replace(/[^\w\s]/g,"")).split(" ")).slice(0,5)).join("%20")).replace(",","%20"),console.log(n);var i="http://localhost:8888/get_lyrics/?artist="+n+"&name="+a.replace(" ","%20");fetch(i).then(function(e){return e.json()}).then(function(a){var n=a.lyrics.song_lyrics.split("\n");e.setState({nowPlaying:{name:t.item.name,artist:t.item.artists[0].name,albumArt:"undefined"!==typeof t.item.album?t.item.album.images[0].url:"",total_time:t.item.duration_ms,time_left:t.item.duration_ms-t.progress_ms,lyrics:n}})}).catch(function(e){return console.log("lyrical error:"+e)})}).catch(function(e){return console.log("There was an error:"+e)})}},{key:"render",value:function(){var e=this,t=this.state.nowPlaying.lyrics.map(function(e){return""===e?i.a.createElement("br",{key:e.uniqueId}):i.a.createElement("div",{key:e.uniqueId},e)});return i.a.createElement("div",{className:"Lyrics"},this.state.loggedIn&&i.a.createElement(i.a.Fragment,null," ",i.a.createElement("input",{id:"mycheckbox",onClick:function(){return e.getNowPlaying()},type:"checkbox"}),i.a.createElement("label",{htmlFor:"mycheckbox"})),!this.state.loggedIn&&i.a.createElement("a",{href:"http://localhost:8888/login"},"Connect your Spotify"),i.a.createElement("div",null,this.state.nowPlaying.name,i.a.createElement("div",{style:{width:"300px",margin:"auto"}},i.a.createElement(g.a,{active:!0,striped:!0,bsStyle:"info",now:Math.floor(100*(1-this.state.nowPlaying.time_left/this.state.nowPlaying.total_time))}))),i.a.createElement("div",null,i.a.createElement("div",{className:"image-shadow js-tilt-container",style:{backgroundImage:"url("+this.state.nowPlaying.albumArt+")"}},i.a.createElement("br",null),i.a.createElement("br",null))),i.a.createElement("div",null,"Lyrics: ",t),i.a.createElement("br",null))}}]),t}(n.Component),b=a(8),w=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this))).play=e.play.bind(Object(b.a)(Object(b.a)(e))),e.host="ariczhuang.ddns.net:80",e.state={isPlaying:!1,icon:"fa fa-play fa-2x",marginLeft:"12px"},e}return Object(u.a)(t,e),Object(s.a)(t,[{key:"setDevice",value:function(){var e;return-1!==(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?alert("Opera"):-1!==navigator.userAgent.indexOf("Chrome")?e=1.45:-1!==navigator.userAgent.indexOf("Safari")?e=0:-1!==navigator.userAgent.indexOf("Firefox")?e=0:-1<navigator.userAgent.indexOf("Edge")?e=0:-1!==navigator.userAgent.indexOf("MSIE")||1===!!document.documentMode?alert("IE"):alert("unknown"),console.log(e),e}},{key:"play",value:function(){if(this.state.isPlaying){(e=document.getElementById("background")).pause(),e.src="",this.setState({isPlaying:!1,icon:"fa fa-play fa-2x",marginLeft:"12px"})}else{var e=document.getElementById("background");console.log(this),e.src="http://"+this.host+"/stream",e.currentTime=this.setDevice(),e.play(),this.setState({isPlaying:!0,icon:"fa fa-pause fa-2x",marginLeft:"0px"})}}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{id:"a"},i.a.createElement("audio",{id:"background"},i.a.createElement("source",{src:"",preload:"none",type:"audio/mpeg"})),i.a.createElement("button",{className:"round-button",id:"player",onClick:function(){return e.play()}},i.a.createElement("i",{className:this.state.icon,style:{fontSize:"100px",marginLeft:this.state.marginLeft}})))}}]),t}(n.Component),E=a(92),x=a(91),k=a(89),P=(a(83),function(){return i.a.createElement("div",null,i.a.createElement("br",null),i.a.createElement(k.a,{style:{textDecoration:"none",width:"150px"},className:"button",to:"/lyrics"},"My Lyrics"),i.a.createElement("br",null),i.a.createElement(k.a,{style:{textDecoration:"none",width:"150px"},className:"button",to:"/stream"},"Radio Stream"))}),_=function(){return i.a.createElement(E.a,null,i.a.createElement("div",null,i.a.createElement(P,null),i.a.createElement(x.a,{exact:!0,path:"/",component:v}),i.a.createElement(x.a,{path:"/lyrics",component:v}),i.a.createElement(x.a,{path:"/stream",component:w})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(E.a,{basename:"/spotify-lyrics-app"},i.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[44,2,1]]]);
//# sourceMappingURL=main.98138ef5.chunk.js.map